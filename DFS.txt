FUNC POINTEQUAL POINT A POINT B PEND
 DEF TX NUM 0 DEF TY NUM 0;
 DEF SX NUM 0 DEF SY NUM 0;
 SPLIT SX SY REF A;
 SPLIT TX TY REF B;
 IF CALC EQUAL REF TX REF SX END
  IF CALC EQUAL REF TY REF SY END
   RET VALUE NUM 1;
  END END
 END END
 RET VALUE NUM 0;
END
FUNC CONSTRUCTPATH MAP CURRENT PEND
 DEF PATH ARRAY EMPTY;
 DEF CNODE NUM 0;
 DEF CPARENT MAP EMPTY;
 DEF CPARENTNODE NUM 0;
 LOOP
  ASSIGN CNODE MAP CURRENT GET ANY REF SELF;
  ASSIGN CPARENT MAP CURRENT GET ANY REF PARENT;
  ASSIGN CPARENTNODE MAP CPARENT GET ANY REF SELF;
  DEF TMP NUM 0;
  IF CALC GREE REF CPARENTNODE 0 END
   RET DEBUG VALUE ANY REF PATH END
  END
  ASSIGN TMP CALL POINTEQUAL REF CNODE REF CPARENTNODE
  CALC SUB 1 REF TMP;
 END
  ARRAY PATH INSERT 0 ANY REF CNODE;
  ASSIGN CURRENT VALUE ANY REF CPARENT;
 END
 RET VALUE ANY REF PATH;
END
FUNC DFS POINT START POINT GOAL PEND
 DEF CLOSESET ARRAY EMPTY;
 DEF OPENSET ARRAY EMPTY;
 DEF CAMEFROM ARRAY EMPTY;
 DEF PARENT NUM 1;
 DEF SELF NUM 0;
 DEF TMPSET NUM 0;
 ASSIGN TMPSET INFO WALL;
 ARRAY TMPSET FOREACH ITEM
  BLOCK DEF X MAP EMPTY; MAP X SET ANY REF SELF ANY REF ITEM;
  ARRAY CLOSESET PUSH ANY REF X;
 END;
 DEF TMPMAP MAP EMPTY;
 MAP TMPMAP SET ANY REF PARENT ANY REF START;
 MAP TMPMAP SET ANY REF SELF ANY REF START;
 ARRAY OPENSET PUSH ANY REF TMPMAP;
 LOOP ARRAY OPENSET LENGTH END
  DEF CURRENT MAP EMPTY;
  DEF CURRENTNODE NUM 0;
  ASSIGN CURRENT ARRAY OPENSET POP;
  ASSIGN CURRENTNODE MAP CURRENT GET ANY REF SELF;
  IF CALL POINTEQUAL REF CURRENTNODE REF GOAL END
   RET CALL CONSTRUCTPATH REF CURRENT;
  END END
  ARRAY CLOSESET PUSH ANY REF CURRENT;
  DEF LIST ARRAY EMPTY;
  ASSIGN LIST GETNEIGHBORS REF CURRENTNODE REF OPENSET REF CLOSESET;
  ARRAY LIST FOREACH TMP BLOCK
   DEF NODE MAP EMPTY;
   MAP NODE SET ANY REF PARENT ANY REF CURRENT;
   MAP NODE SET ANY REF SELF ANY REF TMP;
   ARRAY OPENSET PUSH ANY REF NODE;
  END
 END
 RET VALUE NUM 0;
END
FUNC SMOVETO POINT TARGET PEND
 DEF TX NUM 0 DEF TY NUM 0;
 DEF SX NUM 0 DEF SY NUM 0;
 DEF DX NUM 0 DEF DY NUM 0;
 DEF CP NUM 0;
 ASSIGN CP CURPOS;
 SPLIT SX SY REF CP;
 SPLIT TX TY REF TARGET;
 ASSIGN DX CALC SUB REF TX REF SX;
 ASSIGN DY CALC SUB REF TY REF SY;
 IF CALC INEQUAL REF DX 0 END
  IF CALC GRE REF DX 0 END FACETO RIGHT END FACETO LEFT END;
  TRAN RIG REF DX;
 END END;
 IF CALC INEQUAL REF DY 0 END
  IF CALC GRE REF DY 0 END FACETO BOTTOM END FACETO TOP END;
  TRAN BOT REF DY;
 END END;
END
FUNC FINDPATH POINT TGT PEND
 DEF CUR NUM 0;
 ASSIGN CUR CURPOS;
 DEF PATH NUM 0;
 DEBUG ASSIGN PATH CALL DFS REF CUR REF TGT;
 DEBUG ARRAY PATH FOREACH ITEM
  DEBUG CALL SMOVETO REF ITEM;
END

BINDPATHFINDING FINDPATH;